{"version":3,"sources":["webpack:///./src/views/subviews/Search.vue?9943","webpack:///src/views/subviews/Search.vue","webpack:///./src/views/subviews/Search.vue?c39a","webpack:///./src/views/subviews/Search.vue","webpack:///./src/views/subviews/Search.vue?92cb"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","directives","name","rawName","value","$store","state","loadshow","expression","_l","post","key","id","bot","refInFor","staticStyle","attrs","cloudinaryURL","username","_v","_s","on","$event","menu","btnsub","path","heart","like","likedBy","length","caption","errormessage","_e","staticRenderFns","data","error","posts","from","to","isload","unheart","obj","beforeCreate","created","loaddata","commit","computed","token","mounted","methods","initScroll","product","click","mouseWheel","component"],"mappings":"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","file":"js/search.b9982408.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"product\",staticClass:\"search\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.$store.state.loadshow),expression:\"!$store.state.loadshow\"}],staticClass:\"postlist\"},_vm._l((_vm.posts),function(post){return _c('div',{key:post.id,staticClass:\"card\"},[(post && post.bot)?_c('div',[_c('div',{ref:\"loadmore\",refInFor:true,staticClass:\"loadmore\"})]):_c('div',[_c('div',{staticClass:\"title\"},[_c('img',{staticClass:\"profile\",staticStyle:{\"border-radius\":\"50%\"},attrs:{\"src\":_vm.cloudinaryURL + post.username + '.jpg',\"alt\":\"user img\",\"width\":\"25\",\"height\":\"25\"}}),_c('div',{staticClass:\"profile\"},[_vm._v(_vm._s(post.username))]),_c('img',{staticClass:\"dot\",attrs:{\"src\":require(\"@/img/obium.svg\"),\"alt\":\"\"},on:{\"click\":function($event){return _vm.menu(post)}}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(post.menu),expression:\"post.menu\"}],staticClass:\"menu\"},[_c('div',{staticClass:\"xyz\",on:{\"click\":function($event){return _vm.btnsub('/user/follow',post.username)}}},[_vm._v(\"Subscribe\")]),_c('div',{staticClass:\"xyz\",on:{\"click\":function($event){return _vm.btnsub('/user/block',post.username)}}},[_vm._v(\"Block\")])]),_c('div',{staticClass:\"pic\"},[_c('img',{staticStyle:{\"width\":\"100%\",\"height\":\"300px\"},attrs:{\"src\":post.path,\"alt\":\"user post\"}})]),_c('div',{staticClass:\"iconlist\"},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(!post.heart),expression:\"!post.heart\"}],staticClass:\"icon\",attrs:{\"src\":require(\"@/img/heart.svg\"),\"alt\":\"share\",\"width\":\"20\",\"height\":\"20\"},on:{\"click\":function($event){return _vm.like(post)}}}),_vm._v(\" \"),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(post.heart),expression:\"post.heart\"}],staticClass:\"icon\",attrs:{\"src\":require(\"@/img/like.svg\"),\"alt\":\"share\",\"width\":\"20\",\"height\":\"20\"},on:{\"click\":function($event){return _vm.like(post)}}}),_c('div',{staticClass:\"icon\"},[_vm._v(_vm._s(post.likedBy.length)+\" likes\")]),_c('img',{staticClass:\"icon\",attrs:{\"src\":require(\"@/img/share.svg\"),\"alt\":\"share\",\"width\":\"20\",\"height\":\"20\"}})]),_c('div',{staticClass:\"describe\"},[_c('p',{staticStyle:{\"marginLeft\":\"10px\",\"marginBottom\":\"10px\",\"marginTop\":\"3px\"}},[_vm._v(\" \"+_vm._s(post.caption)+\" \")])])])])}),0),_c('Load-com',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.$store.state.loadshow),expression:\"$store.state.loadshow\"}]}),(_vm.error)?_c('Error-com',{attrs:{\"errormessage\":_vm.errormessage}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search\" ref=\"product\">\r\n    <div class=\"postlist\" v-show=\"!$store.state.loadshow\">\r\n      <div class=\"card\" v-for=\"post in posts\" :key=\"post.id\">\r\n        <div v-if=\"post && post.bot\">\r\n          <div class=\"loadmore\" ref=\"loadmore\"></div>\r\n        </div>\r\n        <div v-else>\r\n          <div class=\"title\">\r\n            <img\r\n              :src=\"cloudinaryURL + post.username + '.jpg'\"\r\n              alt=\"user img\"\r\n              width=\"25\"\r\n              height=\"25\"\r\n              style=\"border-radius: 50%\"\r\n              class=\"profile\"\r\n            />\r\n            <div class=\"profile\">{{ post.username }}</div>\r\n            <img src=\"@/img/obium.svg\" alt=\"\" class=\"dot\" @click=\"menu(post)\" />\r\n          </div>\r\n          <div v-show='post.menu' class=\"menu\" >\r\n            <div class=\"xyz\" @click=\"btnsub('/user/follow',post.username)\">Subscribe</div>\r\n            <div class=\"xyz\" @click=\"btnsub('/user/block',post.username)\">Block</div>\r\n          </div>\r\n          <div class=\"pic\">\r\n            <img\r\n              :src=\"post.path\"\r\n              alt=\"user post\"\r\n              style=\"width: 100%; height: 300px\"\r\n            />\r\n          </div>\r\n          <div class=\"iconlist\">\r\n            <img v-show=\"!post.heart\" src=@/img/heart.svg alt=\"share\" width=\"20\"\r\n            height=\"20\" class=\"icon\" @click=\"like(post)\" /> <img\r\n            v-show=\"post.heart\" src=@/img/like.svg alt=\"share\" width=\"20\"\r\n            height=\"20\" class=\"icon\" @click=\"like(post)\" />\r\n            <div class=\"icon\">{{ post.likedBy.length }} likes</div>\r\n            <img\r\n              src=\"@/img/share.svg\"\r\n              alt=\"share\"\r\n              width=\"20\"\r\n              height=\"20\"\r\n              class=\"icon\"\r\n            />\r\n          </div>\r\n          <div class=\"describe\">\r\n            <p style=\"marginLeft: 10px; marginBottom: 10px; marginTop: 3px\">\r\n              {{ post.caption }}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <Load-com v-show=\"$store.state.loadshow\"></Load-com>\r\n    <Error-com v-if=\"error\" :errormessage=\"errormessage\"></Error-com>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAllPosts, likepost } from \"@/network/api\";\r\nimport BScroll from \"better-scroll\";\r\nimport { bf } from \"@/network/api\";\r\n\r\nexport default {\r\n  name: \"Search\",\r\n  data() {\r\n    return {\r\n      error: false,\r\n      errormessage: \"\",\r\n      cloudinaryURL: \"https://res.cloudinary.com/hkeunji7l/\",\r\n      posts: [],\r\n      from: 0,\r\n      to: 10,\r\n      isload: { num: 0, loading: false },\r\n      unheart: \"@/img/heart.svg\",\r\n      obj: { name: \"axia\", age: \"000\" },\r\n    };\r\n  },\r\n  beforeCreate() {\r\n    this.$store.state.loadshow = true\r\n  },\r\n  created() {\r\n    this.loaddata();\r\n    this.$store.commit('setLoading')\r\n  },\r\n\r\n  computed: {\r\n    username() {\r\n      return this.$store.state.username;\r\n    },\r\n    token() {\r\n      return this.$store.state.token;\r\n    },\r\n  },\r\n\r\n  mounted() {},\r\n\r\n  methods: {\r\n    async loaddata() {\r\n      try {\r\n        let result = await getAllPosts(\r\n          this.$store.state.username,\r\n          this.from,\r\n          this.to\r\n        );\r\n        result.forEach((element) => {\r\n          element.heart = element.likedBy.includes(this.username);\r\n          element.menu = false;\r\n        });\r\n        console.log(\"OK\", result);\r\n        result.push({\r\n          bot: true,\r\n        });\r\n        this.posts = result;\r\n\r\n        this.$nextTick(() => {\r\n          this.initScroll();\r\n          let io = new IntersectionObserver(this.loaddown);\r\n          io.observe(document.querySelector(\".loadmore\"));\r\n        });\r\n      } catch (error) {\r\n        this.errormessage = error;\r\n        this.error = true;\r\n      }\r\n    },\r\n\r\n    async loaddown() {\r\n      this.isload.num++;\r\n      if (\r\n        this.isload.num > 1 &&\r\n        !this.isload.loading &&\r\n        this.posts.length >= this.to - 1\r\n      ) {\r\n        // console.log('loading')\r\n        this.from += 10\r\n        this.to += 10;\r\n        this.isload.loading = true;\r\n        try {\r\n          let result = await getAllPosts(\r\n            this.$store.state.username,\r\n            this.from,\r\n            this.to\r\n          );\r\n          result.forEach((element) => {\r\n            element.heart = element.likedBy.includes(this.username);\r\n          });\r\n\r\n          this.posts.pop();\r\n          result.push({\r\n            bot: true,\r\n          });\r\n          this.posts = this.posts.concat(result);\r\n          this.$nextTick(() => {\r\n            if(this.product) {\r\n              this.product.refresh()\r\n            }\r\n          });\r\n          this.isload.loading = false;\r\n        } catch (error) {\r\n          this.errormessage = error;\r\n          this.error = true;\r\n        }\r\n      }\r\n    },\r\n\r\n    initScroll() {\r\n      let product = this.$refs.product;\r\n      this.product = new BScroll(product, {\r\n        click: true,\r\n        mouseWheel: true,\r\n      });\r\n    },\r\n\r\n    menu(post) {\r\n      post.menu = !post.menu\r\n    },\r\n\r\n    async btnsub(url, username) {\r\n      try {\r\n        let result = await bf(url, username, this.$store.state.token)\r\n        if(result == 'Authentication Failed.') {\r\n          localStorage.clear()\r\n          this.$store.commit('setUser')\r\n          this.$router.replace({\r\n            path: \"/\",\r\n          });\r\n        }else {\r\n          this.posts = this.posts.filter(item => item.username !== username)\r\n          this.$nextTick(() => {\r\n            if(this.product) {\r\n              this.product.refresh()\r\n            }\r\n          });\r\n          console.log(this.posts, username)\r\n        }\r\n      } catch (error) {\r\n          this.errormessage = error;\r\n          this.error = true;\r\n      }\r\n    },\r\n\r\n    async like(post) {\r\n      if (post.heart) {\r\n        post.heart = !post.heart;\r\n        post.likedBy = post.likedBy.filter((name) => name !== this.username);\r\n        let result = await likepost(\"post/unlike\", post._id, this.token);\r\n        if (result === \"Authentication Failed.\") {\r\n          sessionStorage.clear();\r\n          this.$store.commit(\"setUser\");\r\n          this.$router.replace({\r\n            path: \"/\",\r\n          });\r\n        }\r\n      } else {\r\n        post.heart = !post.heart;\r\n        post.likeBy = post.likedBy.push(this.username);\r\n        let result = await likepost(\"post/like\", post._id, this.token);\r\n        if (result === \"Authentication Failed.\") {\r\n          sessionStorage.clear();\r\n          this.$store.commit(\"setUser\");\r\n          this.$router.replace({\r\n            path: \"/\",\r\n          });\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.search {\r\n  height: 430px;\r\n  overflow: hidden;\r\n}\r\n.postlist {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.card {\r\n  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.25);\r\n  margin-top: 10px;\r\n}\r\n\r\n.title {\r\n  display: flex;\r\n  align-items: center;\r\n  padding-right: 10px;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.dot {\r\n  margin-left: auto;\r\n  cursor: pointer;\r\n}\r\n\r\n.profile {\r\n  margin-left: 10px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.pic {\r\n  width: 100%;\r\n  height: 300px;\r\n}\r\n\r\n.iconlist {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n}\r\n\r\n.icon {\r\n  margin-left: 10px;\r\n  margin-top: 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.loadmore {\r\n  width: 100%;\r\n  height: 20px;\r\n  /* display: none; */\r\n  background-color: transparent;\r\n}\r\n\r\n.describe p{\r\n  width: 100%;\r\n  word-wrap:break-word;\r\n  word-break:break-all;\r\n}\r\n\r\n.menu {\r\n  display: flex;\r\n  text-align: center;\r\n  flex-direction: row;\r\n  background-color: #68E3AC;\r\n}\r\n\r\n.xyz {\r\n  margin: 0 auto;\r\n  cursor: pointer;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=3a4926f2&scoped=true&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&id=3a4926f2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a4926f2\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&id=3a4926f2&scoped=true&lang=css&\""],"sourceRoot":""}